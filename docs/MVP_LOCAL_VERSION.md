# SoundZone MVP - ローカル版

## 概要

SoundZoneのMVP（Minimum Viable Product）版です。音声の録音、保存、再生、管理をすべてローカルデバイス上で行います。

## 主な機能

### ✅ 実装済み機能

1. **音声録音**
   - expo-audioを使用した高品質な音声録音
   - 録音開始前の権限確認
   - リアルタイムの録音時間表示
   - 一時停止・再開機能

2. **音声プレビュー**
   - 録音した音声の即座に再生
   - メタデータ（タイトル・説明）の入力
   - 波形風のビジュアル表示
   - ローカル保存の実行

3. **ローカルストレージ管理**
   - デバイス内の専用ディレクトリに音声ファイルを保存
   - AsyncStorageでメタデータを管理
   - ファイルの完全性チェック
   - ストレージ容量の監視

4. **マイ録音管理**
   - 保存された音声の一覧表示
   - 音声の再生・停止
   - 個別の音声削除
   - ストレージ使用量の表示

5. **地図表示**
   - ローカル保存された音声ピンの表示
   - サンプルデータとの統合表示
   - 音声プレイヤーモーダル

## 技術仕様

### ファイル構成

```
src/features/recording/services/
├── localStorageService.ts    # ローカルファイル管理
└── uploadService.ts          # (将来のクラウド対応用)

app/recording/
├── index.tsx                 # 録音画面
└── preview.tsx              # プレビュー画面

src/features/mypin/
└── presentation/
    └── MyPinScreen.tsx      # マイ録音管理画面
```

### データ保存場所

- **音声ファイル**: `{DocumentDirectory}/soundzone_audio/`
- **メタデータ**: AsyncStorage (`soundzone_audio_pins`)

### データ構造

```typescript
interface LocalAudioPin {
  id: string;
  title: string;
  description?: string;
  audioUri: string;      // ローカルファイルパス
  duration: number;      // ミリ秒
  latitude?: number;
  longitude?: number;
  createdAt: string;
  fileName: string;
}
```

## 使用方法

### 1. 音声録音

1. 録音タブをタップ
2. 録音ボタンを押して録音開始
3. 録音ボタンを再度押して停止
4. プレビュー画面に自動遷移

### 2. 音声保存

1. プレビュー画面でタイトルを入力（必須）
2. 説明を入力（オプション）
3. 「保存する」ボタンをタップ
4. ローカルに保存され、ホーム画面に戻る

### 3. 音声管理

1. マイピンタブをタップ
2. 保存された音声の一覧を確認
3. 再生ボタンで音声を再生
4. ゴミ箱ボタンで音声を削除

## 本番環境への移行

このローカル版から本番環境（クラウドストレージ）への移行は、以下の変更で実現できます：

1. **uploadService.ts**を有効化
2. **localStorageService.ts**の代わりにSupabase呼び出しに変更
3. **useAudioPins.ts**でSupabaseから読み込むように変更

### 移行時の利点

- ✅ UI/UXは変更不要
- ✅ 録音・再生ロジックは変更不要
- ✅ データ構造は互換性あり
- ✅ 段階的な移行が可能

## 制限事項

- 音声はデバイス内のみに保存（他デバイスとの同期なし）
- 位置情報機能は未実装（プレースホルダーのみ）
- リアルタイム機能なし（ローカル保存のため）
- バックアップ機能なし

## トラブルシューティング

### 録音できない場合
1. アプリの権限設定でマイクが許可されているか確認
2. デバイスの空き容量を確認

### 音声が再生されない場合
1. ファイルの存在確認（自動で行われる）
2. アプリの再起動

### データが消えた場合
- アプリの削除・再インストールでローカルデータは失われます
- 重要な録音は定期的にバックアップすることを推奨

## 今後の拡張予定

1. 🔄 Supabase連携（クラウドストレージ）
2. 📍 位置情報機能
3. 🔄 リアルタイム同期
4. 📤 音声の共有機能
5. 🎵 音声の編集機能 